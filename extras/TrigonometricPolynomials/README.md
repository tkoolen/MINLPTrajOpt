Heavily based on https://github.com/RobotLocomotion/drake/blob/ae2be680f22f28a4bec82102b47cc7623a9845d4/common/trig_poly.h.
